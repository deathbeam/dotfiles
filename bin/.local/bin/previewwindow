#!/bin/sh
sock="$1"
addr="$2"
path="/tmp/window_preview_${addr}.png"

if [ ! -f "$path" ]; then
  grim -t png -w "$addr" "$path"
fi

echo '{ "command": ["loadfile", "'"$path"'", "replace"] }' | socat - "$sock" >/dev/null 2>&1
